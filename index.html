<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Auth0 구글 로그인</title>
  <script src="https://cdn.auth0.com/js/auth0/9.19/auth0.min.js"></script>
</head>
<body>

  <h2>Auth0 구글 로그인 데모</h2>
  <button id="login">Google로 로그인</button>
  <pre id="result"></pre>

  <script>
    // Auth0 초기화
    var webAuth = new auth0.WebAuth({
      domain: 'dev-pe4wjh07dmtpf32l.us.auth0.com',
      clientID: 'UijBDWTnAdQeb8tV6Dnv87hGQNp4YeoA',
      redirectUri: window.location.href,
      responseType: 'token id_token',
      scope: 'openid profile email'
    });

    // 로그인 버튼 클릭 시
    document.getElementById('login').addEventListener('click', function () {
      webAuth.authorize({
        connection: 'google-oauth2' // 구글로 연결
      });
    });

    // 로그인 후 URL에 포함된 토큰 파싱
    function handleAuthentication() {
      webAuth.parseHash(function (err, authResult) {
        if (authResult && authResult.accessToken && authResult.idToken) {
          webAuth.client.userInfo(authResult.accessToken, function(err, user) {
            if (user) {
              document.getElementById('result').textContent = JSON.stringify(user, null, 2);
            }
          });
        } else if (err) {
          console.log(err);
        }
      });
    }

    // 페이지 로딩 시 바로 실행
    window.addEventListener('load', handleAuthentication);
  </script>
</body>
</html>
